package org.usfirst.frc.team4534.robot;

import java.util.ArrayList;

import edu.wpi.first.wpilibj.AnalogInput;

public class AnalogGyro {
	private AnalogInput gyro;
	private ArrayList<Double> values;
	private Double base;
	private Double angle;
	
	static int SAMPLE_SIZE = 100;
	
	public AnalogGyro(int channel) {
		gyro = new AnalogInput(channel);
		initGyro();
	}
	
	public AnalogGyro(AnalogInput ai) {
		gyro = ai;
		initGyro();
	}
	
	void initGyro() {
		while(values.size() <= SAMPLE_SIZE) {
			values.add(gyro.getVoltage());
		}
		
		Double avg = 0.0;
		for(Double val : values) {
			avg += val;
		}
		avg = avg.doubleValue() / values.size(); //should be around 2.5V with the KOP gyro from recent years (2011-2014)
		base = avg;
	}
	
	Double getAngle() {
		Double alteredValue = gyro.getVoltage() - base;
		
		Double millivolts = alteredValue*1000;
		
		//divide by 7mv per degree, and add to angle
		Double alterAngle = millivolts/7;
		
		angle += alterAngle;
		
		//if less than 0, or greater than 360, loop over
		while(angle < 0) {
			angle += 360;
		}
		
		while(angle > 360) {
			angle -= 360;
		}
	}
	
	private boolean isNegative(Double dub) {
		return !(dub == Math.abs(dub));
	}
}
