package org.usfirst.frc.team4534.robot;

import java.util.ArrayList;

import edu.wpi.first.wpilibj.AnalogInput;

public class AnalogGyro {
	AnalogInput gyro;
	ArrayList<Double> values;
	Double base;
	Integer angle;
	
	static int SAMPLE_SIZE = 100;
	
	public AnalogGyro(int channel) {
		gyro = new AnalogInput(channel);
		initGyro();
	}
	
	public AnalogGyro(AnalogInput ai) {
		gyro = ai;
		initGyro();
	}
	
	void initGyro() {
		while(values.size() <= SAMPLE_SIZE) {
			values.add(gyro.getVoltage());
		}
		
		Double avg = 0.0;
		for(Double val : values) {
			avg += val;
		}
		avg = avg.doubleValue() / values.size(); //should be around 2.5V with the KOP gyro from recent years (2011-2014)
		base = avg;
	}
	
	Double getAngle() {
		Double alteredValue = gyro.getVoltage() - base;
		
		while(Math.abs(alteredValue) > 5.0) {
			//if greater than 5 volts, scale down automatically
			if(isNegative(alteredValue)) {
				alteredValue += 5.0;
			} else {
				alteredValue -= 5.0;
			}
		}
	}
	
	private boolean isNegative(Double dub) {
		return !(dub == Math.abs(dub));
	}
}
